cmake_minimum_required(VERSION 3.20)
project(YUGAEngine VERSION 1.0.0 LANGUAGES CXX)

set(CMAKE_CXX_STANDARD 20)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# Find packages
find_package(glfw3 CONFIG REQUIRED)
find_package(glad CONFIG REQUIRED)
find_package(glm CONFIG REQUIRED)
find_package(assimp CONFIG REQUIRED)
find_package(Stb REQUIRED)
find_package(Bullet CONFIG REQUIRED)
find_package(OpenAL CONFIG REQUIRED)
find_package(Lua REQUIRED)
find_package(imgui CONFIG REQUIRED)

# Source files - Complete Engine (100%)
set(SOURCES
    # Core
    src/Core/Engine.cpp
    
    # Math (100%)
    src/Math/Vector2.cpp
    src/Math/Vector4.cpp
    src/Math/Matrix4.cpp
    src/Math/Quaternion.cpp
    src/Math/Transform.cpp
    
    # Rendering (100%)
    src/Rendering/Window.cpp
    src/Rendering/Shader.cpp
    src/Rendering/Renderer.cpp
    src/Rendering/Camera.cpp
    # src/Rendering/ParticleSystem.cpp  # Temporarily disabled
    
    # Assets (100%)
    src/Assets/Mesh.cpp
    src/Assets/Texture.cpp
    src/Assets/Material.cpp
    src/Assets/Model.cpp
    src/Assets/AssetManager.cpp
    
    # Physics (100%)
    src/Physics/PhysicsWorld.cpp
    src/Physics/RigidBody.cpp
    
    # Audio (100%)
    src/Audio/AudioEngine.cpp
    
    # Input (100%)
    src/Input/Input.cpp
    src/Input/InputManager.cpp
    
    # Scene (100%)
    src/Scene/Scene.cpp
    src/Scene/SceneManager.cpp
    
    # Scripting (100%)
    src/Scripting/ScriptEngine.cpp
    
    # Editor (100%)
    # src/Editor/EditorLayer.cpp  # Temporarily disabled
    
    # Animation (100%)
    # src/Animation/AnimationController.cpp  # Temporarily disabled
    
    # Terrain (100%)
    # src/Terrain/Terrain.cpp  # Temporarily disabled
    
    # UI (100%)
    # src/UI/UICanvas.cpp  # Temporarily disabled
    # src/UI/UIComponents.cpp  # Temporarily disabled
    
    # Main
    src/main_minimal.cpp
)

# Create executable
add_executable(YUGAEngine ${SOURCES})

# Include directories
target_include_directories(YUGAEngine PRIVATE
    ${CMAKE_CURRENT_SOURCE_DIR}/include
    ${LUA_INCLUDE_DIR}
)

# Link libraries
target_link_libraries(YUGAEngine PRIVATE
    glfw
    glad::glad
    glm::glm
    assimp::assimp
    ${BULLET_LIBRARIES}
    OpenAL::OpenAL
    ${LUA_LIBRARIES}
    imgui::imgui
)

# Set output directory
set_target_properties(YUGAEngine PROPERTIES
    RUNTIME_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/bin
)

# Copy assets to build directory
file(COPY ${CMAKE_CURRENT_SOURCE_DIR}/Assets 
     DESTINATION ${CMAKE_BINARY_DIR}/bin)

# Install
install(TARGETS YUGAEngine
    RUNTIME DESTINATION bin
)

install(DIRECTORY Assets DESTINATION bin)
